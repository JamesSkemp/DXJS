function dice(e,t){this.name=e||"unamed dice",this.value=void 0,this.faces=t||[]}dice.prototype.roll=function(){var e=Math.floor(Math.random()*this.faces.length);return this.value=this.faces[e],this.value};var dx=function(){for(var e=2;20>=e;e++){for(var t=[],r=1;e>=r;r++)t.push(r);this["d"+e]=new dice("d"+e,t)}};dx.prototype.showDice=function(){var e=[];for(var t in this)this[t]instanceof dice&&e.push(this[t]);return e},dx.prototype._tryToParseDice=function(e){if(console.log("trying to create dice: ",e),!/[^1-9]{0}d[1-9]+/.test(e))throw"no such dice: "+e;for(var t=/[^1-9]{0}d[1-9]+/.exec(e)[0],r=parseInt(t.replace(/[a-z A-Z]/g,"")),i=[],o=1;r>=o;o++)i.push(o);this[t]=new dice(e,i)},dx.prototype._evaluateSingleRoll=function(e){var t=[],r=/[a-z]/.exec(e).index,i=1;if(r>0&&(i=parseInt(e.substring(0,r))),r>=0){var o=e.substring(r);void 0===this[o]&&this._tryToParseDice(o);for(var a=0,s=0;i>s;s++){var n=this[o].roll();t.push({value:n,"throw":o}),a+=n}}var v=t.reduce(function(e,t,r,i){var o=e;return 0!=r&&(o+="  "),o+t.value},"");return{value:a,"throw":e,rolls:t,overview:v}},dx.prototype.roll=function(e){var t=e.split(/([\+\-\/\*])/),r=[],i=void 0,o=void 0,a="",s=this;return t.forEach(function(e){switch(e){case"+":case"-":case"/":case"*":i=e;break;default:var t=s._evaluateSingleRoll(e.trim());r.push(t),void 0===o&&(o=isNaN(parseInt(t.value))?"":0),"+"===i|void 0===i?o+=t.value:"-"===i?o-=t.value:"*"===i?o*=t.value:"/"===i&&(o/=t.value),void 0!=i&&(a+=" "+i+" "),a+="("+t.overview+") "}}),{value:o,"throw":e,rolls:r,overview:a}},DX=new dx;